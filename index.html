<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Everyday Store</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:linear-gradient(180deg,#050b1f,#0c1430);
  color:#fff;
}
.container{
  max-width:420px;
  margin:20px auto;
  background:rgba(0,0,0,.4);
  padding:20px;
  border-radius:18px;
}
h1{text-align:center;}
input,select,button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:12px;
  border:none;
}
button{
  background:#2ecc71;
  font-weight:bold;
  cursor:pointer;
}
.qr-box{text-align:center;margin-top:12px}
#qrImage{width:220px;display:none}
#processingBox,#successBox{display:none;text-align:center;margin-top:12px}
.footer{text-align:center;font-size:13px;margin-top:20px;opacity:.9}
.footer a{color:#2ecc71;text-decoration:none;margin:0 6px}
#topAuth{position:fixed;top:10px;left:10px;z-index:9999}
</style>
</head>

<body>

<div id="topAuth">
  <button id="loginBtn">Sign In</button>
  <button id="logoutBtn" style="display:none">Logout</button>
</div>

<div class="container">
<h1>Everyday Store</h1>

<input id="playerID" placeholder="Player ID">
<input id="serverID" placeholder="Server ID">
<input id="mobile" placeholder="Mobile Number">
<input id="email" placeholder="Email" readonly>

<select id="pack">
<option value="">Select Pack</option>
<option value="3 Diamonds - ₹8">3 Diamonds - ₹8</option>
<option value="5 Diamonds - ₹12">5 Diamonds - ₹12</option>
<option value="11 Diamonds - ₹23">11 Diamonds - ₹23</option>
<option value="Weekly Pass - ₹133">Weekly Pass - ₹133</option>
</select>

<div class="qr-box">
<img id="qrImage">
</div>

<button id="orderBtn">Order After Payment</button>

<div id="processingBox">⏳ Processing order...</div>
<div id="successBox">
✅ Order Placed<br>
<b>Order ID:</b> <span id="orderId"></span><br>
Status: Pending
</div>

<div class="footer">
<a href="reviews.html">Reviews</a> |
<a href="terms.html">Terms</a> |
Support: <b>7679393645</b>
</div>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, serverTimestamp } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyB7ZS8S879-gQFikWqy4yOrDja7DzboK",
  authDomain: "everyday-store-6debb.firebaseapp.com",
  projectId: "everyday-store-6debb"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

loginBtn.onclick = () => signInWithPopup(auth, provider);
logoutBtn.onclick = () => signOut(auth);

onAuthStateChanged(auth,user=>{
  if(user){
    loginBtn.style.display="none";
    logoutBtn.style.display="block";
    email.value=user.email;
  }else{
    loginBtn.style.display="block";
    logoutBtn.style.display="none";
    email.value="";
  }
});

pack.onchange=()=>{
  if(pack.value){
    qrImage.src="https://everydaystore.github.io/mlbb-topup/qr/default.png";
    qrImage.style.display="block";
  }else qrImage.style.display="none";
};

orderBtn.onclick = async ()=>{
  if(!auth.currentUser){
    alert("Sign in first");
    return;
  }

  if(!playerID.value || !serverID.value || !mobile.value || !pack.value){
    alert("Fill all details");
    return;
  }

  processingBox.style.display="block";

  const oid="ORD-"+Date.now();

  await addDoc(collection(db,"orders"),{
    orderId:oid,
    email:auth.currentUser.email,
    playerID:playerID.value,
    serverID:serverID.value,
    mobile:mobile.value,
    pack:pack.value,
    status:"pending",
    created:serverTimestamp()
  });

  processingBox.style.display="none";
  successBox.style.display="block";
  orderId.innerText=oid;
};
</script>

</body>
</html>
